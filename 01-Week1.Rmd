# Week 1
```{r include=FALSE}
# automatically create a bib database for R packages
```

## Mini-Example
### Task Description
The goal of the mini-example is to examine the association between firm’s discretionary spending (advertising, R&D) and top-line financial impact (sales)

- How many variables are in the dataset? Which ones are identifier, categorical vs. continuous?
- What is(are) the focal outcome variable(s)?
- What is(are) the focal predictor variable(s)?
- What is(are) the focal “control” variable(s)?
- What is the mean of sales, advertising and R&D?
- How are sales, advertising and R&D different in b2b vs. b2c firms?
- How do advertising and R&D affect sales?

### Variables in the Data
| Variable Name |What does it mean? | 
|---------------|:-------------:|
| gvkey          |6-digit Firm id| 
| datadate       |fiscal year    |
| pure_b2b       |Indicator: Only in B2B sector (1) – otherwise (0)|
| Sales |  Sales in Millions of Dollars|
| xad |Advertising expenditure in millions of dollars|
| xrd |R&D expenditure in millions of dollars|
| fmsize_at |Natural log of the book value of total assets|
| mksh2 |Ratio of firm’s overall sales revenue to the sales revenue of all firms in the same 2-digit SIC code industry|






### Analysis using R

The first step is to include all the libraries we use in this exercise. An alternative approach is to load libraries specific to functions before using the function.
```{r include=TRUE  ,message=FALSE}
library(readxl)
library(dplyr)
library(ggplot2)
```

The next step is to import data. We will use the *read_excel* function to import excel file into R.

You can use the [*setwd*](http://rfunction.com/archives/1001) function to set the working directory to the folder which has your data or give the full path of your excel file wile reading the excel file.

```{r include=TRUE }
# Importing Data
mini_case_data <- read_excel("Mini-case data.xlsx")
```

#### Summary Statistics

In R, there are multiple ways to check the summary statistics of your data. ([Link 1](http://www.sthda.com/english/wiki/descriptive-statistics-and-graphics),[Link 2](https://www.statmethods.net/stats/descriptives.html))

```{r include=TRUE }
# Summary stats - sales
summary_sales <- mini_case_data %>% summarise(n = n(), mean_sales = mean(sales),std_dev_sales = sd(sales), min_sale = min(sales), max_sales = max(sales) )

summary_sales
# Summary stats - xad
summary_xad <- mini_case_data %>% summarise(n = n(), mean_xad = mean(xad),std_dev_xad = sd(xad), min_sale = min(xad), max_xad = max(xad) )

summary_xad
# Summary stats - xrd
summary_xrd <- mini_case_data %>% summarise(n = n(), mean_xrd = mean(xrd),std_dev_xrd = sd(xrd), min_sale = min(xrd), max_xrd = max(xrd) )

summary_xrd

```

#### Sales Regression

The following link provides a brief introduction to linear regression.

  - [http://uc-r.github.io/linear_regression](http://uc-r.github.io/linear_regression)

For our sales regression

  - Dependent Variable : sales
  - Independet Variables: xad,xrd

```{r include=TRUE }
sales_regression  <-  lm(sales ~ xad+xrd , data =mini_case_data )

# Summary of the regression
summary(sales_regression)$coefficients

summary(sales_regression)$r.squared
```

The regression results show the following

- Advertising (25.0773) and R&D (3.3464) have a positive effect on revenue
- R-squared (model fit index) is 0.5117


We can add more control variables to the regression model

 - Control Variables: pure_b2b, fmsize_at, mksh2
```{r include=TRUE }
sales_regression_with_controls  <-  lm(sales ~ xad+xrd+pure_b2b+fmsize_at+mksh2 ,data =mini_case_data )

# Summary of the regression
summary(sales_regression_with_controls)$coefficients

summary(sales_regression_with_controls)$r.squared

```


For the new model

 - R-squared (model fit index) improves to 0.6434 from 0.5117
 - The relationship between control variables and sales makes sense


## Customer Model Analytics I: Regression